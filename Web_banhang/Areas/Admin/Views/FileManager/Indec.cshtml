@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers

@{
    ViewData["Title"] = "Quản lý tài nguyên";
    ViewData["parent"] = "";
    Layout = "~/Areas/Admin/Views/Shared/_Layout.cshtml";

}
@section leftnavbar{

    <li class="nav-item d-none d-sm-inline-block">
        <a href="" class="nav-link"> @ViewData["parent"]</a>
    </li>
    <li class="nav-item d-none d-sm-inline-block">
        <a href="#" class="nav-link">@ViewData["Title"]</a>
    </li>
}
@section pageHeader{
    <li class="breadcrumb-item active">@ViewData["Title"]</li>
}


<form>
    <div class="form-group">
        <label id="Content" class="control-label"></label>
        <textarea id="Content" class="form-control"></textarea>
        <span id="Content" class="text-danger"></span>
    </div>
</form>
<button id="elfinder_button">Elfinder button</button>
<div id="elfinder_content">

</div>

@section script{
    @await Html.PartialAsync("Summernote", new {height = 200, selector = "#Content"})

    <link href="~/lib/elfinder/css/elfinder.full.css" rel="stylesheet" />
    <link href="~/lib/elfinder/css/theme.min.css" rel="stylesheet" />

    <link href="~/lib/jqueryui/themes/base/jquery-ui.css" rel="stylesheet" />
    <link href="~/lib/jqueryui/themes/base/jquery-ui.min.css" rel="stylesheet" />
    <link href="~/lib/jqueryui/themes/base/theme.css" rel="stylesheet" />
    <link href="~/lib/jqueryui/themes/base/theme.min.css" rel="stylesheet" />

    <script src="~/lib/jqueryui/jquery-ui.js"></script>
    <script src="~/lib/jqueryui/jquery-ui.min.js"></script>

    <script src="~/lib/elfinder/js/elfinder.min.js"></script>
    <script type="text/javascript">
        // Documentation for client options:
        // https://github.com/Studio-42/elFinder/wiki/Client-configuration-options
        $(document).ready(function () {
            //var myCommands = elFinder.prototype._options.commands;

            //// Not yet implemented commands in elFinder.NetCore
            //var disabled = ['callback', 'chmod', 'editor', 'netmount', 'ping', 'search', 'zipdl', 'help'];
            //elFinder.prototype.i18.en.messages.TextArea = "Edit";

            //$.each(disabled, function (i, cmd) {
            //    (idx = $.inArray(cmd, myCommands)) !== -1 && myCommands.splice(idx, 1);
            //});

            //var options = {
            //    baseUrl: "/lib/elfinder/",
            //    url: "/el-finder-file-system/connector",
            //    rememberLastDir: false,
            //    commands: myCommands,
            //    lang: 'vi',
            //    uiOptions: {
            //        toolbar: [
            //            ['back', 'forward'],
            //            ['reload'],
            //            ['home', 'up'],
            //            ['mkdir', 'mkfile', 'upload'],
            //            ['open', 'download'],
            //            ['undo', 'redo'],
            //            ['info'],
            //            ['quicklook'],
            //            ['copy', 'cut', 'paste'],
            //            ['rm'],
            //            ['duplicate', 'rename', 'edit'],
            //            ['selectall', 'selectnone', 'selectinvert'],
            //            ['view', 'sort']
            //        ]
            //    },
            //    //onlyMimes: ["image", "text/plain"] // Get files of requested mime types only
            //    lang: 'vi',
            //};
            //$('#elfinder').elfinder(options).elfinder('instance');


            //function elfinderDialog(editor) {
            //    var fm = $('<div/>').dialogelfinder({
            //        url: '/el-finder-file-system/connector', // change with the url of your connector
            //        baseUrl: "/lib/elfinder/",
            //        lang: 'vi',
            //        width: 840,
            //        height: 450,
            //        destroyOnClose: true,
            //        getFileCallback: function (files, fm) {
            //            console.log(files);
            //            editor.invoke('editor.insertImage', files.url);
            //        },
            //        commandsOptions: {
            //            getfile: {
            //                oncomplete: 'close',
            //                folders: false
            //            }
            //        }
            //    }).dialogelfinder('instance');
            //}

            $('#elfinder_button').click(function () {
                //alert("The button was clicked.");
                var fm = $('<div/>').dialogelfinder({
                    url: '/el-finder-file-system/connector', // change with the url of your connector
                    baseUrl: "/lib/elfinder/",
                    lang: 'vi',
                    width: 840,
                    height: 450,
                    destroyOnClose: true,
                    getFileCallback: function (files) {
                       
                        console.log(files);
                       // debugger;
                       //console.log($('#editor').closest('.elfinder-input'));
                        console.log(files.url);
                        //editor.invoke('editor.insertImage', files.url);
                        var content = '<div id="elfinder_content"><strong>'+ files.name +'</strong></div>';
                        $('#elfinder_content').replaceWith(content);
                    },
                    
                    commandsOptions: {
                        getfile: {
                            oncomplete: 'close',
                            folders: false
                        }
                    }
                }).dialogelfinder('instance');
            });
        });
    </script>
}